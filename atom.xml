<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Michael`Blog</title>
  
  
  <link href="http://michael8023.github.io/atom.xml" rel="self"/>
  
  <link href="http://michael8023.github.io/"/>
  <updated>2022-10-31T10:20:34.331Z</updated>
  <id>http://michael8023.github.io/</id>
  
  <author>
    <name>Michael Liu</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>cmake</title>
    <link href="http://michael8023.github.io/post/233853f2.html"/>
    <id>http://michael8023.github.io/post/233853f2.html</id>
    <published>2022-10-31T10:16:26.000Z</published>
    <updated>2022-10-31T10:20:34.331Z</updated>
    
    <content type="html"><![CDATA[<h1 id="cmake-教程"><a href="#cmake-教程" class="headerlink" title="cmake 教程"></a>cmake 教程</h1><h3 id="CMake一个HelloWorld的语法介绍"><a href="#CMake一个HelloWorld的语法介绍" class="headerlink" title="CMake一个HelloWorld的语法介绍"></a>CMake一个HelloWorld的语法介绍</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">project(HELLO)</span><br><span class="line">set(SRC<span class="emphasis">_LIST main.cpp)</span></span><br><span class="line"><span class="emphasis">message(status &quot;this is binary dir &quot; $&#123;HELLO_</span>BINARY<span class="emphasis">_DIR&#125;)</span></span><br><span class="line"><span class="emphasis">message(status &quot;this is source dir&quot; $&#123;HELLO_</span>SOURCE<span class="emphasis">_DIR&#125;)</span></span><br><span class="line"><span class="emphasis">add_</span>executable(hello $&#123;SRC<span class="emphasis">_LIST&#125;)</span></span><br></pre></td></tr></table></figure><h3 id="PROJECT关键字"><a href="#PROJECT关键字" class="headerlink" title="PROJECT关键字"></a>PROJECT关键字</h3><p>可以用来指定工程的==名字和支持的语言==，默认支持所有语言</p><p>PROJECT(HELLO)</p><p>PROJECT(HELLO CXX C)</p><p>该指定隐式定义了两个CMAKE的变量</p><p><projectname>_BINARY_DIR和<projectname>_SOURCE_DIR</p><p>MESSAGE关键字就可以直接使用这两个变量，当前都指向当前的工作目录，后面会讲外部编译</p><p>问题：如果改了工程名，这两个变量名也会改变</p><p>解决：又定义两个预定义变量：PROJECT_BINARY_DIR和PROJECT_SOURCE_DIR，这两个变量内容和原来是一致的</p><h3 id="SET关键字"><a href="#SET关键字" class="headerlink" title="SET关键字"></a>SET关键字</h3><p>用来显示的指定变量的</p><p>set(SRC_LIST main.cpp) SRC_LIST变量就包含了main.cpp</p><p>也可以SET(SRC_LIST main.cpp t1.cpp t2.cpp)</p><h3 id="MESSAGE关键字"><a href="#MESSAGE关键字" class="headerlink" title="MESSAGE关键字"></a>MESSAGE关键字</h3><p>向终端输出用户自定义的信息</p><p>主要包含三种信息：</p><ul><li>SEND_ERROR，产生错误，生成过程被跳过</li><li>SATUS，输出前缀为—的信息</li><li>FATAL_ERROR，立即终止所有CMake的过程</li></ul><h3 id="ADD-EXECUTABLE关键字"><a href="#ADD-EXECUTABLE关键字" class="headerlink" title="ADD_EXECUTABLE关键字"></a>ADD_EXECUTABLE关键字</h3><p>生成可执行文件</p><p>ADD_EXECUTABLE(hello ${SRC_LIST})生成可执行文件hello，源文件读取变量SRC_LIST中的内容</p><p>也可直接写ADD_EXECUTABLE(hello main.cpp)</p><blockquote><p>注意：工程名和生成的可执行文件是没有任何关系的</p></blockquote><h3 id="语法的基本原则"><a href="#语法的基本原则" class="headerlink" title="语法的基本原则"></a>语法的基本原则</h3><ul><li>变量使用${}取值，但是在IF控制语句是直接使用变量名</li><li>指令的参数都是用圆括号括起来的，参数之间使用==空格或者逗号==分隔开</li><li>指令是大小写无关的，参数和变量是大小写相关的</li></ul><h3 id="语法注意"><a href="#语法注意" class="headerlink" title="语法注意"></a>语法注意</h3><ul><li>SET(SRC_LIST main.cpp)可以写成SET(SRC_LIST “main.cpp”)，如果源文件名中含有空格，则必须加双引号</li><li>ADD_EXECUTABLE(hello main)后缀可以不写，他会自动去找cpp和c，但是不建议这样写</li></ul><h3 id="内部构建和外部构建"><a href="#内部构建和外部构建" class="headerlink" title="内部构建和外部构建"></a>内部构建和外部构建</h3><ul><li>内部构建产生的临时文件多</li><li>外部构建就是把生成的文件放在build文件夹下，不会对源文件产生任何的影响</li></ul><h3 id="让Hello-World看起来更像一个工程"><a href="#让Hello-World看起来更像一个工程" class="headerlink" title="让Hello World看起来更像一个工程"></a>让Hello World看起来更像一个工程</h3><ul><li>为工程添加一个子目录src，用来放置工程源代码</li><li>添加一个子目录doc，用来放置这个工程文档的hello.txt</li><li>在工程目录添加文本文件COPYRIGHT,README</li><li>在工程目录添加一个 <code>runhello.sh</code>脚本，用来调用hello二进制</li><li>将构建好后的目标文件放入构建目录的bin子目录</li><li>将doc目录的内容以及COPYRIGHT/README安装到/usr/share/doc/cmake</li></ul><h3 id="将目标文件放入构建目录的bin子目录"><a href="#将目标文件放入构建目录的bin子目录" class="headerlink" title="将目标文件放入构建目录的bin子目录"></a>将目标文件放入构建目录的bin子目录</h3><p><img src="D:\Huawei Share\Screenshot\capture_20221022153432562.bmp" alt="capture_20221022153432562"></p><p>外层CMakeLists.txt</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">project</span>(hello)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(src bin)</span><br></pre></td></tr></table></figure><p>src下的CMakeLists.txt</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_exectable(hello main.cpp)</span><br></pre></td></tr></table></figure><h3 id="ADD-SUBDIRECTORY指令"><a href="#ADD-SUBDIRECTORY指令" class="headerlink" title="ADD_SUBDIRECTORY指令"></a>ADD_SUBDIRECTORY指令</h3><p>ADD_SUBDORECTORY{source_dir [binary] [EXCLUDE_FROM_ALL]}</p><ul><li>这个指令用于向当前工程添加存放源文件的子目录，并可以指定中间二进制和目标二进制存放的位置</li><li>EXCLUDE_FROM_ALL函数是将写的目录从编译中排除，如程序中的example</li><li>add_subdirectory(src bin)</li></ul><p>​        将src子目录加入工程并指定编译输出路径为bin目录</p><p>如果不进行bin目录的指定，那么编译结果（包括中间结果）都将放在build/src</p><ul><li>要写在最外层</li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul><li>一种是从代码编译后直接make install安装</li><li>一种是打包时的指定目录安装<ul><li>简单的可以这样指定目录：make install DESTDIR==/tmp/test</li><li>稍微复杂的可以这样指定目录：./configure -prefix=/usr</li></ul></li></ul><h3 id="如何安装HelloWorld"><a href="#如何安装HelloWorld" class="headerlink" title="如何安装HelloWorld"></a>如何安装HelloWorld</h3><p>使用cmake一个新指令：INSTALL</p><p>​    INSTALL的安装可以包括：二进制、动态库、静态库以及文件、目录、脚本等</p><p>使用CMAKE一个新的变量：CMAKE_INSTALL_PREFIX</p><p><img src="D:\Huawei Share\Screenshot\capture_20221022155756666.bmp" alt="capture_20221022155756666"></p><h4 id="安装文件COPYRIGHT和README"><a href="#安装文件COPYRIGHT和README" class="headerlink" title="安装文件COPYRIGHT和README"></a>安装文件COPYRIGHT和README</h4><p>INSTALL(FILES COPYRIGHT README DESTINATION share/doc/cmake)</p><p>FILES:文件</p><p>DESTINATION:</p><ol><li>写绝对路径</li><li>可以写相对路径，相对路径其实是：${CMAKE_INSTALL_PREFIX}/<DESTINATION定义的路径></li></ol><p>​        CMAKE_INSTALL_PREFIX 默认是在/usr/local/</p><p>​        cmake -DCMAKE_INSTALL_PREFIX=/usr 在cmake的时候指定的DCMAKE_INSTALL_PREFIX变量的路径</p><h4 id="安装脚本"><a href="#安装脚本" class="headerlink" title="安装脚本"></a>安装脚本</h4><p>PROGRAMS:非可执行程序</p><p>INSTALL(PROGRAMS runhello.sh DESTINATION bin)</p><h4 id="安装doc中的hello-txt"><a href="#安装doc中的hello-txt" class="headerlink" title="安装doc中的hello.txt"></a>安装doc中的hello.txt</h4><p>一、是通过在Doc目录中建立CMakeLists.txt，通过install下的file</p><p>二、是直接在工程目录通过</p><p>INSTALL(DIRECTORY doc==/== DESTINATION share/doc/cmake)</p><p>DESTINATION后面连接的是所在Source目录的相对路径</p><blockquote><p>注意：doc目录不以/结尾，表示安装这个目录</p><p>以/结尾，表示安装这个目录下的内容</p></blockquote><h3 id="静态库和动态库的构建"><a href="#静态库和动态库的构建" class="headerlink" title="静态库和动态库的构建"></a>静态库和动态库的构建</h3><p>任务：</p><ol><li>建立一个静态库和动态库，提供HelloFunc函数供其他程序编程使用，HelloFunc向终端输出Hello World字符</li><li>安装头文件与共享库</li></ol><p>静态库与动态库的区别</p><ul><li>静态库的扩展名一般为“.a”或”.lib”；动态库的扩展名一般为”.so” or “.dll”</li><li>静态库在编译时会直接整合到目标程序中，编译成功的可执行文件可独立运行</li><li>动态库在编译的时候不会放到连接的目标程序中，即可执行文件无法独立运行</li></ul><h4 id="ADD-LIBRARY"><a href="#ADD-LIBRARY" class="headerlink" title="ADD_LIBRARY"></a>ADD_LIBRARY</h4><p>ADD_LIBRARY(hello SHARED ${LIBHELLO_SRC})</p><ul><li>HELLO:就是库名，最后生成的时lib会加到前面，即为libhello.so</li><li>SHARED,动态库    STATIC，静态库</li><li>${LIBHELLO_SRC}源文件</li></ul><blockquote><p>若要同时构建动态库和静态库，则必须把两个库的名字区别开，否则只会构建出动态库</p></blockquote><p>同时构建动态库和静态库</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span>(LIBHELLO_SRC hello.cpp)</span><br><span class="line"><span class="keyword">ADD_LIBRARY</span>(hello_static STATIC <span class="variable">$&#123;LIBHELLO_SRC&#125;</span>)</span><br><span class="line"><span class="comment">#对hello_static重命名为hello</span></span><br><span class="line"><span class="keyword">SET_TARGET_PROPERTIES</span>(hello_static PROPERTIES OUTPUT_NAME <span class="string">&quot;hello&quot;</span>)</span><br><span class="line"><span class="comment">#cmake在构建一个新的target时，会尝试清理掉其他这个名字的库，比如，在构建libhello.so时，就会清理掉libhello.a</span></span><br><span class="line"><span class="keyword">SET_TARGET_PROPERTIES</span>(hello_static PROPERTIES CLEAN_DIRECT_OUTPUT <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD_LIBRARY</span>(hello SHARED <span class="variable">$&#123;LIBHELLO_SRC&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET_TARGET_PROPERTIES</span>(hello PROPERTIES OUTPUT_NAME <span class="string">&quot;hello&quot;</span>)</span><br><span class="line"><span class="keyword">SET_TARGET_PROPERTIES</span>(hello PROPERTIES CLEAN_DIRECT_OUTPUT <span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="安装共享库和头文件"><a href="#安装共享库和头文件" class="headerlink" title="安装共享库和头文件"></a>安装共享库和头文件</h4><p>本例中我们将hello的共享库安装到<prefix>/lib目录</p><p>将hello.h安装到<prefix>/include/hello目录</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSTALL</span>(FIELS hello.h DESTINATION <span class="keyword">include</span>/hello)</span><br><span class="line"><span class="comment">#二进制，静态库，动态库都用TARGET</span></span><br><span class="line"><span class="comment">#ARCHIVE 特指静态库，LIBRARY特指动态库，RUNTIME，特指可执行目标二进制</span></span><br><span class="line"><span class="keyword">INSTALL</span>(<span class="keyword">TARGET</span> hello hello_static LIBRARY DESTINATION lib ARCHIVE DESTINATION lib)</span><br></pre></td></tr></table></figure><h4 id="使用共享库和头文件"><a href="#使用共享库和头文件" class="headerlink" title="使用共享库和头文件"></a>使用共享库和头文件</h4><p>解决：make后头文件找不到的问题</p><p>PS：include <hello/hello.h></p><p>关键字：INCLUDE_DIRECTORIES 这条指令可以用来向工程添加多个特定的头文件搜索路径，路径之间用空格分隔</p><p>在CMakeLists.txt中加入头文件搜索路径</p><p>INCLUDE_DIRECTORIES(/usr/include/hello)</p><p>解决：找到引用函数问题</p><p>关键字：LINK_DIRECTORIES(/usr/include/hello)添加非标准的共享库搜索路径</p><p>关键字：TARGET_LINK_LIBRARIES(可执行文件名  共享库)</p><blockquote><p>在CMakeLists.txt中插入连接共享库，主要要插在executable后面</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;cmake-教程&quot;&gt;&lt;a href=&quot;#cmake-教程&quot; class=&quot;headerlink&quot; title=&quot;cmake 教程&quot;&gt;&lt;/a&gt;cmake 教程&lt;/h1&gt;&lt;h3 id=&quot;CMake一个HelloWorld的语法介绍&quot;&gt;&lt;a href=&quot;#CMake一个</summary>
      
    
    
    
    
    <category term="计算机视觉" scheme="http://michael8023.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>OpenCV learning</title>
    <link href="http://michael8023.github.io/post/a206aef0.html"/>
    <id>http://michael8023.github.io/post/a206aef0.html</id>
    <published>2022-10-31T08:14:30.000Z</published>
    <updated>2022-10-31T10:09:21.780Z</updated>
    
    <content type="html"><![CDATA[<h1 id="opencv-note"><a href="#opencv-note" class="headerlink" title="opencv note"></a>opencv note</h1><ul><li><p>第一章 安装</p></li><li><p>第二章 核心功能</p><ul><li><p>==基本图像容器 Mat==</p></li><li><p>==矩阵掩码==</p></li><li><p>==改变图像的对比度和亮度==</p></li><li><p>==基本绘图==</p></li><li><p>==随机数==和==文字输入==</p></li><li><p>输出 XML 和 YAML 文件</p></li></ul></li><li><p>第三章 图像处理</p><ul><li><p>==腐蚀与膨胀；形态学变换==</p></li><li><p>==基本的阈值操作==</p></li><li><p>在图像中寻找轮廓</p></li><li><p>为轮廓创建可倾斜的边界框和椭圆</p></li></ul></li></ul><h3 id="4-1-2-Mat-结构的使用"><a href="#4-1-2-Mat-结构的使用" class="headerlink" title="4.1.2 Mat 结构的使用"></a>4.1.2 Mat 结构的使用</h3><p>​    关于Mat类，我们首先要知道的是：</p><p>（1）不必再手动为其开辟空间。</p><p>（2）不必再在不需要时立即将空间释放</p><p>总结：</p><ul><li>OpenCV 函数中输出图像的内存分配是自动完成的</li><li>使用opencv的c++结构时不需要考虑内存释放的问日</li><li>赋值运算符和拷贝构造函数 <code>Mat B(A)</code>只复制信息头</li><li>使用函数 <code>clone（）</code>或者 <code>copyTo（）</code>来复制一副图像的矩阵 </li></ul><h3 id="4-1-3-像素值的存储方法"><a href="#4-1-3-像素值的存储方法" class="headerlink" title="4.1.3 像素值的存储方法"></a>4.1.3 像素值的存储方法</h3><ul><li>RGB/RGBA</li><li>YCrCb在JPEG中广泛使用</li><li>HSV和HLS 把颜色分解成色调、饱和度和亮度。</li></ul><h3 id="4-1-4-显式创建Mat对象的七种方式"><a href="#4-1-4-显式创建Mat对象的七种方式" class="headerlink" title="4.1.4 显式创建Mat对象的七种方式"></a>4.1.4 显式创建Mat对象的七种方式</h3><ul><li><p>【方法一】使用Mat（）构造函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Mat <span class="title">M</span><span class="params">(<span class="number">2</span>,<span class="number">2</span>,CV_8UC3,Scalar(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>))</span></span>;</span><br><span class="line"><span class="comment">//CV_[位数][带符号与否][类型前缀]C[通道数]</span></span><br><span class="line"><span class="comment">//预先定义的通道数可以多达4个</span></span><br></pre></td></tr></table></figure></li><li><p>【方法二】在C/C++中通过构造函数进行初始化</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> sz[<span class="number">3</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>&#125;;</span><br><span class="line"><span class="function">Mat <span class="title">L</span><span class="params">(<span class="number">3</span>,sz,cv_8UC,Scalar::all(<span class="number">0</span>))</span></span>;</span><br><span class="line"><span class="comment">//上面的例子演示了如何创建一个超过两维的矩阵：指定维数，然后传递给一个指向数组的指针，这个数组包含每个维度的尺寸；后续两个参数与方法一中的相同</span></span><br></pre></td></tr></table></figure></li><li><p>【方法三】为已存在的IplImage指针创建信息头</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IplImage* img = <span class="built_in">cvLoadImage</span>(<span class="string">&quot;1.jpg&quot;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="function">Mat <span class="title">mtx</span><span class="params">(img)</span></span>;<span class="comment">//转换 IplImage*-&gt;Mat</span></span><br></pre></td></tr></table></figure></li><li><p>【方法四】利用Create（）函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M.<span class="built_in">create</span>(<span class="number">4</span>,<span class="number">4</span>,<span class="built_in">CV_8UC</span>(<span class="number">2</span>));</span><br><span class="line"><span class="comment">//需要注意的是，此方法不能为矩阵设初值，只是在该百年尺寸时重新为矩阵数据开辟内存而已。</span></span><br></pre></td></tr></table></figure></li><li><p>【方法六】对小矩阵使用逗号分隔式初始化函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mat C = (<span class="built_in">Mat_</span>&lt;<span class="type">double</span>&gt;(<span class="number">3</span>,<span class="number">3</span>)&lt;&lt;<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">5</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;C = &quot;</span>&lt;&lt;endl&lt;&lt;<span class="string">&quot; &quot;</span>&lt;C&lt;&lt;endl&lt;&lt;endl;</span><br></pre></td></tr></table></figure></li><li><p>【方法七】为已存在的对象创建新信息头</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mat RowClone = C.<span class="built_in">row</span>(<span class="number">1</span>).<span class="built_in">clone</span>();</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;RowClone = &quot;</span>&lt;&lt;endl&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;RowClone&lt;&lt;endl&lt;&lt;endl;</span><br><span class="line"><span class="comment">//方法七为使用成员函数clone()或者copyTo()为一个已存在的Mat对象创建一个新的信息头</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="cvtColor"><a href="#cvtColor" class="headerlink" title="cvtColor"></a>cvtColor</h1><ul><li>cvtColor的功能是把图像从一个色彩空间转换到另外一个色彩空间，有三个参数，第一个参数表示源图像，第二个参数表示色彩空间转换之后的图像，第三个参数表示源和目标色彩空间如：COLOR_BGR2HLS、COLOR_BGR2GRAY等</li><li>cvtColor(image,gray_image,COLOR_BGR2GRAY);</li></ul><h1 id="imwrite"><a href="#imwrite" class="headerlink" title="imwrite"></a>imwrite</h1><ul><li>保存文件到指定的目录途径</li><li>只有8位，16位的PNG/JPG/Tiff文件格式而且是单通道或者三通道的BGR图像 才可以通过这种方式保存</li><li>保存PNG格式的时候可以保存透明通道的图片（RGBA）</li><li>可以指定压缩参数</li></ul><h1 id="矩阵的掩码操作"><a href="#矩阵的掩码操作" class="headerlink" title="矩阵的掩码操作"></a>矩阵的掩码操作</h1><ul><li><p>获取图像像素指针</p></li><li><p>掩码操作解释</p></li><li>代码演示</li></ul><p>像素处理范围 <code>saturate_cast&lt;uchar&gt;</code>  这个函数的功能是确保RGB值得范围在0~255之间</p><p>掩码操作实现图像对比度的调整 $I(i,j)=5*I(i,j)-[I(i-1,j)+I(i+1,j)+I(i,j-1),I(i,j+1)]$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Mat src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line">Mat dst;</span><br><span class="line"><span class="keyword">if</span> (!src.data)<span class="comment">//如果图像为空，返回 error</span></span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;can&#x27;t load this img&quot;</span> &lt;&lt;std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;input image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;input image&quot;</span>, src);</span><br><span class="line"><span class="comment">//RGB图像按列存储，注意存储顺序是BGR</span></span><br><span class="line"><span class="type">int</span> cols = (src.cols - <span class="number">1</span>) * src.<span class="built_in">channels</span>();</span><br><span class="line">    <span class="comment">//cols 应该用width更为妥当，-1是因为要空出一列像素以防无定义</span></span><br><span class="line"><span class="type">int</span> offsetx = src.<span class="built_in">channels</span>();</span><br><span class="line">    <span class="comment">//偏移量是通道数</span></span><br><span class="line"><span class="type">int</span> rows = src.rows;</span><br><span class="line">    <span class="comment">//RGB按照列存储，与行数无关</span></span><br><span class="line">dst = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), src.<span class="built_in">type</span>());</span><br><span class="line">    <span class="comment">//重新创建一个mat矩阵用于存放输出的图像</span></span><br><span class="line">    <span class="comment">//src.copyTo(dst);也可</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">1</span>; row &lt; rows - <span class="number">1</span>; row++) &#123;</span><br><span class="line"><span class="type">const</span> uchar* previous = src.<span class="built_in">ptr</span>&lt;uchar&gt;(row - <span class="number">1</span>);</span><br><span class="line"><span class="type">const</span> uchar* current = src.<span class="built_in">ptr</span>&lt;uchar&gt;(row);</span><br><span class="line"><span class="type">const</span> uchar* next = src.<span class="built_in">ptr</span>&lt;uchar&gt;(row +<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//创建核的数组</span></span><br><span class="line">uchar* output = dst.<span class="built_in">ptr</span>&lt;uchar&gt;(row);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> col = offsetx; col &lt; cols; col++) &#123;</span><br><span class="line">output[col] = <span class="built_in">saturate_cast</span>&lt;uchar&gt;(<span class="number">5</span> * current[col] - (current[col - offsetx] + current[col + offsetx] + previous[col] + next[col]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;constrast image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;constrast image&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021070916590138.png" alt="img"></p><h2 id="函数filter-2D实现掩码操作"><a href="#函数filter-2D实现掩码操作" class="headerlink" title="函数filter 2D实现掩码操作"></a>函数filter 2D实现掩码操作</h2><p>可直接用opencv的API做掩码操作来提高对比度</p><p><strong>filter2D(src,dst,src.depth(),kernel):其中src与dst是Mat类型变量，src.depth表示位图深度，有32、24、8等，直接写-1表示与输入图深度一致。（filter滤波器）</strong></p><p>定义掩码： <code>Mat lernel = (Mat_&lt;char&gt;(3,3)&lt;&lt;0,-1,0,-1,5,-1,0,-1,0);</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line">Mat src = <span class="built_in">imread</span>(<span class="string">&quot;C:/Users/admin/Desktop/lenna.png&quot;</span>);<span class="comment">//读入图片</span></span><br><span class="line">Mat dst;<span class="comment">//提高对比度之后的图片矩阵</span></span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>())&#123; <span class="comment">// 特判</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;cannot see\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;opencv setup1&quot;</span>, CV_WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;opencv setup1&quot;</span>, src);</span><br><span class="line">Mat kernel = (<span class="built_in">Mat_</span>&lt;<span class="type">char</span>&gt;(<span class="number">3</span>, <span class="number">3</span>) &lt;&lt; <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">5</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>);<span class="comment">//定义掩码规则</span></span><br><span class="line"><span class="built_in">filter2D</span>(src, dst, src.<span class="built_in">depth</span>()<span class="comment">/*-1*/</span>, kernel);</span><br><span class="line"><span class="comment">//输出目标图像</span></span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;opencv setup2&quot;</span>, CV_WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;opencv setup2&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);   <span class="comment">//以便在退出程序前调用系统的暂停命令暂停命令行</span></span><br><span class="line"><span class="comment">//爽得很！！</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Mat"><a href="#Mat" class="headerlink" title="Mat"></a>Mat</h2><p>mat对象的使用：</p><ul><li>部分复制：一般情况下只会复制mat对象的头和指针部分，不会复制数据部分 </li><li>完全复制：使用如下两个API：</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mat F=A.<span class="built_in">clone</span>();</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line">Mat G;</span><br><span class="line">A.<span class="built_in">copyTo</span>(G);</span><br></pre></td></tr></table></figure><p>函数用法：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Mat src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!src.data)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;can&#x27;t load this img&quot;</span> &lt;&lt;std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//namedWindow(&quot;input image&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">//imshow(&quot;input image&quot;, src);</span></span><br><span class="line"><span class="comment">/*Mat dst;</span></span><br><span class="line"><span class="comment">dst = Mat(src.size(), src.type());</span></span><br><span class="line"><span class="comment">dst = Scalar(255, 0, 255);</span></span><br><span class="line"><span class="comment">namedWindow(&quot;out put&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">imshow(&quot;out put&quot;, dst);*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*Mat dst = src.clone();</span></span><br><span class="line"><span class="comment">namedWindow(&quot;out put&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">imshow(&quot;out put&quot;, dst);*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Mat dst;</span></span><br><span class="line"><span class="comment">//cvtColor(src, dst, COLOR_BGR2GRAY); </span></span><br><span class="line"><span class="comment">//namedWindow(&quot;out put&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">//imshow(&quot;out put&quot;, dst);</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; src.channels() &lt;&lt; endl;//通道数目</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; dst.channels() &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//int cols = dst.cols;//全部的列</span></span><br><span class="line"><span class="comment">//int rows = dst.rows;//全部的行</span></span><br><span class="line"><span class="comment">//const uchar* firstRow = dst.ptr&lt;uchar&gt;(0);</span></span><br><span class="line"><span class="comment">//printf(&quot;%d&quot;, *firstRow);</span></span><br><span class="line"><span class="function">Mat <span class="title">M</span><span class="params">(<span class="number">3</span>, <span class="number">3</span>, CV_8UC3, Scalar(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>))</span></span>;</span><br><span class="line">    </span><br><span class="line">    Mat  m1;</span><br><span class="line">    m1.<span class="built_in">create</span>(src.<span class="built_in">size</span>(),src.<span class="built_in">type</span>());</span><br><span class="line">    m1=<span class="built_in">Scalar</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>);</span><br><span class="line">    </span><br><span class="line">    Mat m2 = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(),src.<span class="built_in">type</span>()); </span><br><span class="line">      Mat m2 = Mat::<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">2</span>,CV_8UC1);</span><br><span class="line">      Mat m2 = Mat::<span class="built_in">eye</span>(<span class="number">2</span>,<span class="number">2</span>,CV_8UC1); </span><br><span class="line">    </span><br><span class="line">cout &lt;&lt; M &lt;&lt; endl;</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="图片操作"><a href="#图片操作" class="headerlink" title="图片操作"></a>图片操作</h1><h2 id="读写图像"><a href="#读写图像" class="headerlink" title="读写图像"></a>读写图像</h2><ul><li><code>imread</code>可以指定加载为灰度图像或者RGB图像</li><li><code>imwrite</code>保存图像文件，类型由扩展名决定</li></ul><h2 id="读写像素（pixel）"><a href="#读写像素（pixel）" class="headerlink" title="读写像素（pixel）"></a>读写像素（pixel）</h2><ul><li>读取一个GRAY像素点的像素值(CV_8UC1)</li></ul><p><code>Scalar intensity = img.at&lt;uchar&gt;(y,x);</code>或者</p><p><code>Scalar intensity = img.at&lt;uchar&gt;(Point(y,x));</code></p><ul><li>读一个RGB像素点的像素值</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vec3f intensity = img.at&lt;Vec3f&gt;(y,x);</span><br><span class="line">float blue = intensity.val[0];</span><br><span class="line">float green = intensity.val[1];</span><br><span class="line">float red = intensity.val[2];</span><br></pre></td></tr></table></figure><ul><li><p>获取像素的练习</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/core/utils/logger.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cv::utils::logging::<span class="built_in">setLogLevel</span>(utils::logging::LOG_LEVEL_SILENT);<span class="comment">//不再输出日志</span></span><br><span class="line">Mat src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> output_origin[] = <span class="string">&quot;origin demo&quot;</span>;</span><br><span class="line"><span class="type">char</span> output_gray[] = <span class="string">&quot;gray demo&quot;</span>;</span><br><span class="line"><span class="built_in">namedWindow</span>(output_origin, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(output_origin, src);</span><br><span class="line">Mat dst;</span><br><span class="line"><span class="built_in">cvtColor</span>(src, dst, COLOR_BGR2GRAY);</span><br><span class="line"><span class="built_in">namedWindow</span>(output_gray, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(output_gray, dst);</span><br><span class="line">dst.<span class="built_in">create</span>(src.<span class="built_in">size</span>(), src.<span class="built_in">type</span>());</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; dst.rows; row++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt;dst.cols; col++) &#123;</span><br><span class="line"><span class="comment">//int gray = dst.at&lt;uchar&gt;(row,col);</span></span><br><span class="line"><span class="comment">//dst.at&lt;uchar&gt;(row,col) = 255 - gray;</span></span><br><span class="line"><span class="type">int</span> b = src.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">0</span>];</span><br><span class="line"><span class="type">int</span> g = src.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> r = src.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">2</span>];</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">0</span>]=<span class="number">255</span>-b;</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">1</span>] = <span class="number">255</span> -g;</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">2</span>] = <span class="number">255</span> - r;</span><br><span class="line">            <span class="comment">//另一种转换成灰度图像的方法：</span></span><br><span class="line">            <span class="comment">//dst.at&lt;uchar&gt;(row,col)=max(r,max(b,g));</span></span><br><span class="line">            <span class="comment">//dst.at&lt;uchar&gt;(row,col)=min(r,min(b,g));</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;anti color demo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;anti color demo&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//已经有封装好的API干嘛要练习这个</span></span><br><span class="line"><span class="built_in">bitwise_not</span>(src,dst);</span><br></pre></td></tr></table></figure><h3 id="Vec3b与Vec3f"><a href="#Vec3b与Vec3f" class="headerlink" title="Vec3b与Vec3f"></a>Vec3b与Vec3f</h3></li><li><p>Vec3b对应的三通道的顺序是blue、green、red的uchar类型的数据</p></li><li><p>Vec3f对应三通道的float类型数据</p></li><li><p>把CV_8UC1转换到CV32F1实现如下： <code>src.convertTo(dst,CV_32F);</code></p></li></ul><h1 id="图像混合"><a href="#图像混合" class="headerlink" title="图像混合"></a>图像混合</h1><h4 id="理论-线性混合操作"><a href="#理论-线性混合操作" class="headerlink" title="理论-线性混合操作"></a>理论-线性混合操作</h4><script type="math/tex; mode=display">g(x)=(1-\alpha)f_0(x)+\alpha f_1(x)\\其中\alpha的取值范围为0到1之间</script><p>相关的API(==addWeighted==):</p><p><code>addWeight(src1,alpha,src2,beta,gamma(校验值),dst);</code></p><p>$dst(I)=saturate_cast(src1(I)<em>alpha+src2(I)</em>beta+gamma)$</p><h1 id="改变图像的亮度和对比度"><a href="#改变图像的亮度和对比度" class="headerlink" title="改变图像的亮度和对比度"></a>改变图像的亮度和对比度</h1><p>理论：</p><ul><li><p>图像变换可以看作如下：</p><ul><li>像素变换——点操作</li><li>邻域操作——区域</li></ul><p>调整图像亮度属于像素变换-点操作==$g(i,j)=\alpha f(i,j)+\beta$==其中$\alpha$&gt;0,$\beta$是增益变量</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Mat src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="type">char</span> input_win[] = <span class="string">&quot;src image&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load the image...&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(input_win, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(input_win, src);</span><br><span class="line">Mat dst;</span><br><span class="line"><span class="type">int</span> height = src.rows;</span><br><span class="line"><span class="type">int</span> width = src.cols;</span><br><span class="line">dst = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), src.<span class="built_in">type</span>());</span><br><span class="line"><span class="type">double</span> alpha = <span class="number">1.5</span>;</span><br><span class="line"><span class="type">double</span> beta = <span class="number">10</span>;</span><br><span class="line">src.<span class="built_in">convertTo</span>(src, CV_32F);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; height; row++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; width; col++) &#123;</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">channels</span>() == <span class="number">3</span>) &#123;</span><br><span class="line"><span class="type">float</span> b = src.<span class="built_in">at</span>&lt;Vec3f&gt;(row, col)[<span class="number">0</span>];</span><br><span class="line"><span class="type">float</span> g = src.<span class="built_in">at</span>&lt;Vec3f&gt;(row, col)[<span class="number">1</span>];</span><br><span class="line"><span class="type">float</span> r = src.<span class="built_in">at</span>&lt;Vec3f&gt;(row, col)[<span class="number">2</span>];</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">0</span>] = <span class="built_in">saturate_cast</span>&lt;uchar&gt;(b * alpha + beta);</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">1</span>] = <span class="built_in">saturate_cast</span>&lt;uchar&gt;(g * alpha + beta);</span><br><span class="line">dst.<span class="built_in">at</span>&lt;Vec3b&gt;(row, col)[<span class="number">2</span>] = <span class="built_in">saturate_cast</span>&lt;uchar&gt;(r * alpha + beta);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (src.<span class="built_in">channels</span>() == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="type">int</span> v = src.<span class="built_in">at</span>&lt;uchar&gt;(row, col);</span><br><span class="line">dst.<span class="built_in">at</span>&lt;uchar&gt;(row, col) = <span class="built_in">saturate_cast</span>&lt;uchar&gt;(v * alpha + beta);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//else</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> output_title[] = <span class="string">&quot;contrast and brightness change demo&quot;</span>;</span><br><span class="line"><span class="built_in">namedWindow</span>(output_title, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(output_title, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="绘制图像和文字"><a href="#绘制图像和文字" class="headerlink" title="绘制图像和文字"></a>绘制图像和文字</h2><ul><li><p>使用Point与Scalar</p><ul><li><p>​    Point表示2D平面上一个点(x,y)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Point p;</span><br><span class="line">p.x=<span class="number">10</span>;p.y=<span class="number">8</span>;<span class="comment">//p=Point(10,8);</span></span><br></pre></td></tr></table></figure></li><li><p>Scalar表示四个元素的向量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Scalar(a,b,c);//a=bule,b=green,c=red表示RGB三个通道</span><br></pre></td></tr></table></figure></li></ul></li><li><p>在图片中插入线、矩形、椭圆、圆、多边形。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">Mat src;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lines</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myRectangle</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myEllipse</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myCircle</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myPolygon</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not liad this image..&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">lines</span>();</span><br><span class="line"><span class="built_in">myRectangle</span>();</span><br><span class="line"><span class="built_in">myEllipse</span>();</span><br><span class="line"><span class="built_in">myCircle</span>();</span><br><span class="line"><span class="built_in">myPolygon</span>();</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;line_demo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;line_demo&quot;</span>, src);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lines</span><span class="params">()</span> </span>&#123;<span class="comment">//线</span></span><br><span class="line">Point p1 = <span class="built_in">Point</span>(<span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line">Point p2 = <span class="built_in">Point</span>(<span class="number">200</span>, <span class="number">300</span>);</span><br><span class="line">Scalar color =<span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line"><span class="built_in">line</span>(src, p1, p2, color, <span class="number">5</span>, LINE_AA);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myRectangle</span><span class="params">()</span> </span>&#123;<span class="comment">//矩形</span></span><br><span class="line">Rect rect = <span class="built_in">Rect</span>(<span class="number">200</span>, <span class="number">100</span>, <span class="number">300</span>, <span class="number">300</span>);</span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line"><span class="built_in">rectangle</span>(src, rect, color,<span class="number">1</span>, LINE_8);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myEllipse</span><span class="params">()</span> </span>&#123;<span class="comment">//椭圆</span></span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(<span class="number">175</span>, <span class="number">145</span>, <span class="number">76</span>);</span><br><span class="line"><span class="built_in">ellipse</span>(src, <span class="built_in">Point</span>(src.cols/ <span class="number">2</span>, src.rows / <span class="number">2</span>), <span class="built_in">Size</span>(src.rows / <span class="number">4</span>, src.cols / <span class="number">8</span>), <span class="number">0</span>, <span class="number">0</span>, <span class="number">360</span>, color, <span class="number">1</span>, LINE_AA);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myCircle</span><span class="params">()</span> </span>&#123;<span class="comment">//圆</span></span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(<span class="number">175</span>, <span class="number">146</span>, <span class="number">76</span>);</span><br><span class="line"><span class="built_in">circle</span>(src, <span class="built_in">Point</span>(src.cols / <span class="number">2</span>, src.rows / <span class="number">2</span>), src.cols / <span class="number">4</span>, color, <span class="number">1</span>, LINE_AA);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myPolygon</span><span class="params">()</span> </span>&#123;<span class="comment">//多边形</span></span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</span><br><span class="line">Point pts [<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">0</span>] = <span class="built_in">Point</span>(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">1</span>] = <span class="built_in">Point</span>(<span class="number">100</span>, <span class="number">200</span>);</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">2</span>] = <span class="built_in">Point</span>(<span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">3</span>] = <span class="built_in">Point</span>(<span class="number">200</span>, <span class="number">100</span>);</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">4</span>] = <span class="built_in">Point</span>(<span class="number">150</span>, <span class="number">50</span>);</span><br><span class="line">pts[<span class="number">0</span>][<span class="number">5</span>] = <span class="built_in">Point</span>(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line"><span class="type">const</span> Point* ppts[] = &#123; pts[<span class="number">0</span>] &#125;;</span><br><span class="line"><span class="type">int</span> npt[] = &#123; <span class="number">6</span> &#125;;</span><br><span class="line"><span class="built_in">fillPoly</span>(src, ppts, npt, <span class="number">1</span>, color, <span class="number">8</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在图像中插入文字。<code>putText();</code></p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">Mat src;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not liad this image..&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putText</span>(src, <span class="string">&quot;hello opencv&quot;</span>, <span class="built_in">Point</span>(src.cols / <span class="number">2</span><span class="number">-60</span>, src.rows / <span class="number">2</span>), FONT_HERSHEY_COMPLEX, <span class="number">0.8</span>, <span class="built_in">Scalar</span>(<span class="number">150</span>, <span class="number">12</span>, <span class="number">255</span>), <span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;line_demo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;line_demo&quot;</span>, src);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//随机生成颜色</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>随机生成线条</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">Mat src;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RandowLineDemo</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not liad this image..&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//putText(src, &quot;hello opencv&quot;, Point(src.cols / 2-60, src.rows / 2), FONT_HERSHEY_COMPLEX, 0.8, Scalar(150, 12, 255), 1, 8);</span></span><br><span class="line"><span class="built_in">RandowLineDemo</span>();</span><br><span class="line"><span class="comment">//namedWindow(&quot;line_demo&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">//imshow(&quot;line_demo&quot;, src);</span></span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RandowLineDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="function">RNG <span class="title">rng</span><span class="params">(<span class="number">12346</span>)</span></span>;<span class="comment">//RNG 变量(种子数)</span></span><br><span class="line">Mat bg = Mat::<span class="built_in">zeros</span>(src.<span class="built_in">size</span>(), src.<span class="built_in">type</span>());</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line"><span class="built_in">line</span>(bg, <span class="built_in">Point</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, src.cols), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, src.rows)), <span class="built_in">Point</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, src.cols), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, src.rows)), <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>)), <span class="number">1</span>, LINE_AA);</span><br><span class="line">        <span class="comment">//rng.uniform(范围);</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">waitKey</span>(<span class="number">50</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;RandowLineDemo&quot;</span>, bg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h2 id="模糊图像"><a href="#模糊图像" class="headerlink" title="模糊图像"></a>模糊图像</h2><h3 id="模糊原理"><a href="#模糊原理" class="headerlink" title="模糊原理"></a>模糊原理</h3><ul><li>Smooth/Blur是图像处理中最简单和常用的操作之一</li><li>使用该操作的原因之一就是为了给==图像预处理的时候减低噪声==</li><li>使用Smooth/Blur操作背后是数学的卷积计算 $g(i,j)=\sum\limits_{kj}f(i+k,j+l)h(k,l)$</li><li>通常这些==卷积算子==计算都是线性操作，所以又叫==线性滤波==</li><li>归一化盒子滤波（均值滤波）和高斯滤波（权重不一样，会保留一些原有像素特质）</li><li>相关API<ul><li>均值模糊： <code>blur(Mat src,Mat dst,Size(xradius,yradius),Point(-1,-1));</code></li><li>高斯模糊： <code>GaussianBlur(Mat src,Mat dst,Size(11,11),sigmax,sigmay);</code>其中Size（x，y）必须是正数而且是奇数。</li></ul></li></ul><p>均值模糊</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Mat src, dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;originalDemo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;originalDemo&quot;</span>, src);</span><br><span class="line"><span class="built_in">blur</span>(src, dst, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;blur3Demo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;blur3Demo&quot;</span>, dst);</span><br><span class="line"><span class="built_in">blur</span>(src, dst, <span class="built_in">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;blur5Demo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;blur5Demo&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>高斯模糊</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Mat src, dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;originalDemo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;originalDemo&quot;</span>, src);</span><br><span class="line"><span class="built_in">GaussianBlur</span>(src, dst, <span class="built_in">Size</span>(<span class="number">11</span>, <span class="number">11</span>), <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;GaussianBlurDemo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;GaussianBlurDemo&quot;</span>, dst);</span><br><span class="line"><span class="comment">//blur(src, dst, Size(5, 5), Point(-1, -1));</span></span><br><span class="line"><span class="comment">//namedWindow(&quot;blur5Demo&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="comment">//imshow(&quot;blur5Demo&quot;, dst);</span></span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>中值滤波<ul><li>统计排序滤波器</li><li>中值对椒盐噪声有很好的抑制作用</li></ul></li><li>==高斯双边滤波==<ul><li>均值模糊无法克服边缘像素信息丢失缺陷。原因是均值滤波是基于平均权重</li><li>高斯模糊部分克服了该缺陷，但是无法完全避免，因为没有考虑==像素值的不同==</li><li>高斯双边模糊-是==边缘保留==的滤波方法，==避免看边缘信息丢失==，保留了图像轮廓不变，所以双边模糊需要输入两个，一个空域kernel（空间），一个值域kernel（值）</li></ul></li><li>相关的API<ul><li>中值模糊 <code>medianBlur(Mat src,Mat dest,ksize)</code></li><li>双边模糊 <code>bilateralFilter(src,dest,d=15,150,3);</code><ul><li>15-计算的半径，半径之内的像素都会被纳入计算，如果提供-1则会根据sigma space参数取值</li><li>150-sigma color 决定多少差值之内的像素会被计算</li><li>3-sigma space如果d的值大于0则声明无效，否则根据它来计算d值</li><li>中值模糊的ksize大小必须大于一而且必须是奇数</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Mat src, dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;originalDemo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;originalDemo&quot;</span>, src);</span><br><span class="line"><span class="comment">//GaussianBlur(src, dst, Size(11, 11), 5, 5);</span></span><br><span class="line"><span class="comment">//medianBlur(src, dst, 3);</span></span><br><span class="line"><span class="built_in">bilateralFilter</span>(src, dst, <span class="number">15</span>, <span class="number">150</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;BilateralFilterDemo&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;BilateralFilterDemo&quot;</span>, dst);</span><br><span class="line"></span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="膨胀与腐蚀"><a href="#膨胀与腐蚀" class="headerlink" title="膨胀与腐蚀"></a>膨胀与腐蚀</h2><h4 id="形态学操作-膨胀"><a href="#形态学操作-膨胀" class="headerlink" title="形态学操作-膨胀"></a>形态学操作-膨胀</h4><ul><li>图像形态学操作-基于形状的一系列图像处理操作的合集，主要是基于集合论基础上的形态学数学</li><li>形态学有四个基本操作：膨胀、腐蚀、开、闭</li><li>跟卷积操作类似，假设有图像A和结构元素B，结构元素B在A上面移动，其中B定义其中心为锚点计算B覆盖下A的==最大像素值==（腐蚀是最小像素值）用来替换锚点的像素，其中B作为结构体可以是任意形状</li></ul><h4 id="相关API"><a href="#相关API" class="headerlink" title="相关API"></a>相关API</h4><ul><li><code>getStructuringElement(int shape,Size ksize,Point anchor)</code><ul><li>形状(MORPH_RECT/MORPH_CROSS/MORPH_ELLIPSE)</li><li>大小(奇数)</li><li>锚点 默认是Point(-1,-1)意思就是中心像素</li></ul></li><li><code>dilate(src,dst,kernel)</code></li><li><code>erode(src,dst,kernel)</code></li></ul><h4 id="动态调整结构元素大小"><a href="#动态调整结构元素大小" class="headerlink" title="动态调整结构元素大小"></a>动态调整结构元素大小</h4><ul><li><code>createTrackbar(constString&amp;trackbarname,winname,int*value,int count,Trackbarcallback func,void* userdata=0)</code><ul><li>其中最主要的是callback函数功能。如果设置为NULL就是说只有值update，但是不会调用callback的函数 </li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CallBack_Demo</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;<span class="comment">//回调函数</span></span><br><span class="line"><span class="type">int</span> element_size = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> Max_size = <span class="number">21</span>;</span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data) </span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image..&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;input image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;input image&quot;</span>, src);</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;output image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">createTrackbar</span>(<span class="string">&quot;Element Size:&quot;</span>, <span class="string">&quot;output image&quot;</span>, &amp;element_size, Max_size, CallBack_Demo);</span><br><span class="line"><span class="built_in">CallBack_Demo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CallBack_Demo</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> s = element_size * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">Mat structureElement = <span class="built_in">getStructuringElement</span>(MORPH_RECT, <span class="built_in">Size</span>(s, s), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="comment">//dilate(src, dst, structureElement, Point(-1, -1), 1);//膨胀</span></span><br><span class="line"><span class="built_in">erode</span>(src, dst, structureElement, <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>), <span class="number">1</span>);<span class="comment">//腐蚀</span></span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;output image&quot;</span>, dst);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//深入理解createTrackBar函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="comment">//void CallBack_Demo(int, void*);</span></span><br><span class="line"><span class="type">int</span> element_size = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> Max_size = <span class="number">21</span>;</span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">text</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line">cout &lt;&lt; element_size &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image..&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;测试窗口&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">createTrackbar</span>(<span class="string">&quot;数字&quot;</span>, <span class="string">&quot;测试窗口&quot;</span>, &amp;element_size, Max_size, text);</span><br><span class="line"><span class="built_in">text</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="形态学操作"><a href="#形态学操作" class="headerlink" title="形态学操作"></a>形态学操作</h2><ul><li>相关API<ul><li><code>morphologyEx(src,dest,CV_MOP_BLACKHAT,kernel);</code></li><li>Mat src-输入图像</li><li>Mat dest-输出结果</li><li>int OPT-CV<em>MOP</em>==OPEN==/CV<em>MOP</em>==CLOSE==/CV<em>MOP</em>==GRADIENT==/CV_MOP_TOPHAT/CV_MOP_BLACKHAT形态学操作类型</li><li>Mat kernel -结构元素</li><li>int Iteration-迭代次数，默认是1</li></ul></li><li>开操作-open<ul><li>先腐蚀后膨胀</li><li>可以去掉较小的对象</li></ul></li><li>闭操作-close<ul><li>先膨胀后腐蚀</li><li>可以填充小的洞（fill hole）</li></ul></li><li>形态学梯度-MOPGRADIENT<ul><li>膨胀减去腐蚀</li><li>又称为基本梯度（其他还包括-内部梯度、方向梯度）</li></ul></li><li>顶帽-TOPHAT<ul><li>顶帽是原图像与开操作之间的差值图像</li><li>计算结果是把较小的噪声对象呈现出来</li></ul></li><li>黑帽<ul><li>黑帽是闭操作图像与原图像的差值图像</li></ul></li></ul><blockquote><p>针对二值图像进行处理</p></blockquote><h3 id="形态学操作应用-提取水平与垂直线"><a href="#形态学操作应用-提取水平与垂直线" class="headerlink" title="形态学操作应用-提取水平与垂直线"></a>形态学操作应用-提取水平与垂直线</h3><blockquote><p>膨胀：输出的像素值是结构元素覆盖下输入图像的最大像素值</p><p>腐蚀：输出的像素值是结构元素覆盖下输入图像的最小像素值</p></blockquote><p>结构元素</p><ul><li>上述膨胀与腐蚀过程可以使用任意的结构元素</li><li>常见的形状：直线、圆、磁盘形状等各种自定义形状。</li></ul><p>提取步骤</p><ul><li>输入图像imread</li><li>转换为灰度图像-cvtColor</li><li>转换为二值图像-adaptiveThreshold<ul><li>API说明-adaptiveThreshold</li><li>Mat src-输入的图像</li><li>Mat dest-二值图像</li><li>double maxValue-二值图像最大值</li><li>int adaptiveMethod-自适应方法，只能其中之一-ADAPTIVE_THRESH_MEAN_C,ADAPTIVE_THRESH_GAUSSIAN_C</li><li>int thresholdType-阈值类型（binary）</li><li>int blockSize-块大小（15）</li><li>double C-常量C，可以是正数，0，负数（-2）</li></ul></li><li>定义结构元素</li><li>开操作（腐蚀+膨胀）提取水平与垂直线==在结构元素上做文章，把结构元素定义为水平线或者垂直线==</li><li><code>bitwise_not(src,dst):dst=255-src;</code></li></ul><p>代码样例</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line">Mat src,temp, dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;0-1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this img...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;src&quot;</span>, src);</span><br><span class="line"><span class="built_in">cvtColor</span>(src, temp, COLOR_BGR2GRAY);</span><br><span class="line"><span class="built_in">adaptiveThreshold</span>(temp, temp, <span class="number">255</span>, ADAPTIVE_THRESH_MEAN_C, THRESH_BINARY, <span class="number">15</span>, <span class="number">-2</span>);</span><br><span class="line">Mat x_kernel = <span class="built_in">getStructuringElement</span>(MORPH_RECT, <span class="built_in">Size</span>(src.cols / <span class="number">16</span>, <span class="number">1</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line">Mat y_kernel = <span class="built_in">getStructuringElement</span>(MORPH_RECT, <span class="built_in">Size</span>(<span class="number">1</span>,src.rows/<span class="number">16</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="built_in">morphologyEx</span>(temp, dst, MORPH_OPEN, x_kernel);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bitwise_not</span>(dst, dst);</span><br><span class="line">    <span class="built_in">blur</span>(dst,dst,<span class="built_in">Size</span>(<span class="number">3</span>,<span class="number">3</span>),<span class="built_in">Point</span>(<span class="number">-1</span>,<span class="number">-1</span>));</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;x_line&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;x_line&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>去除干扰项 —转换为二值图像—定义核矩形—形态学操作—开</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line">Mat src,temp, dst;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;ganrao.png&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this img...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;src&quot;</span>, src);</span><br><span class="line"><span class="built_in">cvtColor</span>(src, temp, COLOR_BGR2GRAY);</span><br><span class="line"><span class="built_in">adaptiveThreshold</span>(temp, temp, <span class="number">255</span>, ADAPTIVE_THRESH_MEAN_C, THRESH_BINARY, <span class="number">15</span>, <span class="number">-2</span>);<span class="comment">//自适应阈值，可以转换为二值图像</span></span><br><span class="line">Mat kernel = <span class="built_in">getStructuringElement</span>(MORPH_RECT, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));<span class="comment">//核，getstructingelement获取结构元素</span></span><br><span class="line"><span class="built_in">morphologyEx</span>(temp, dst, MORPH_OPEN, kernel);</span><br><span class="line"><span class="comment">//形态学操作--开--morph——open</span></span><br><span class="line"><span class="built_in">bitwise_not</span>(dst, dst);</span><br><span class="line"></span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;干扰去除&quot;</span>, dst);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="图像上采样与降采样"><a href="#图像上采样与降采样" class="headerlink" title="图像上采样与降采样"></a>图像上采样与降采样</h3><ul><li><p>图像金字塔概念</p><ul><li>采样越多，分辨率越高，金字塔变换特征是不会改变的</li><li>我们在图像畜栏里中常常会调整图像的大小，最常见的就是放大(zoom in)和缩小(zoom out)，尽管几何变换也可以实现图像放大和缩小，但是这里我们介绍图像金字塔</li><li>一个图像金字塔是一系列图像组成，最底下一张是图像尺寸最大，最上方的图像尺寸最小，从孔金赏从上向下看就像一个古代的金字塔。</li><li>高斯金字塔-用来对图像进行降采样<ul><li>从底向上，逐层降采样得到</li><li>降采样之后图像的大小是M/2*N/2，即得到降采样之后上一层的图片</li><li>高斯金字塔的生成过程分为两步：<ul><li>对当前层进行高斯模糊</li><li>删除当前层的偶数行与列</li></ul></li></ul></li><li>拉普拉斯金字塔-用来重建一张图片根据它的上层降采样图片</li><li>高斯不同（Difference of Gaussian-DOG）<ul><li>定义：就是把一张图像在不同的参属下做高斯模糊之后的结果相减，得到的输出图像。称为高斯不同</li><li>高斯不同是图像的内在特征，在灰度图像增强、角点检测中经常用到</li></ul></li></ul></li><li><p>采样API</p><ul><li>上采样(pyrUp)-zoom in 放大</li><li>降采样（pyrDown)-zoom out 缩小</li></ul><p>如何进行上采样和降采样从而得到高斯金字塔的图像，在一个是如何对每一层进行处理得到它的<strong>DOG</strong>，归一化，<strong>彩色图像通道也可做DOG</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line">Mat src,temp, g1,g2,dogImg;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this img...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;src&quot;</span>, src);</span><br><span class="line"><span class="comment">//DOG</span></span><br><span class="line"><span class="built_in">cvtColor</span>(src, temp, COLOR_BGR2GRAY);<span class="comment">//转换为灰度图像</span></span><br><span class="line"><span class="built_in">GaussianBlur</span>(temp, g1, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>);<span class="comment">//两次高斯模糊</span></span><br><span class="line"><span class="built_in">GaussianBlur</span>(g1, g2, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">subtract</span>(g1, g2, dogImg, <span class="built_in">Mat</span>());<span class="comment">//减去</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//归一化显示</span></span><br><span class="line"><span class="built_in">normalize</span>(dogImg, dogImg, <span class="number">255</span>, <span class="number">0</span>, NORM_MINMAX);<span class="comment">//用此函数也可化为0-1图像</span></span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;DOG Image&quot;</span>, dogImg);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="基本阈值操作（threshold）"><a href="#基本阈值操作（threshold）" class="headerlink" title="基本阈值操作（threshold）"></a>基本阈值操作（threshold）</h3><ul><li>阈值是什么，简单来说是把图像分割的标尺</li></ul><h5 id="阈值类型"><a href="#阈值类型" class="headerlink" title="阈值类型"></a>阈值类型</h5><ul><li><p><strong>阈值二值化</strong>（threshold binary）</p></li><li><p><strong>阈值反二值化</strong>（threshold binary Inverted）</p></li><li><strong>阈值截断</strong>(threshold trunc)</li><li><strong>阈值取零</strong>(threshold to zero)</li><li><strong>阈值反取零</strong>(threshold to zero Inverted)<ul><li>OTSU与TRANGLE</li></ul></li></ul><p>首先转化为灰度图像</p><blockquote><p>阈值操作</p></blockquote><p><code>threshold(src,dst,threshold_value,threshold_max,THRESH_TYPE);</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> threshold_value = <span class="number">127</span>;<span class="comment">//阈值</span></span><br><span class="line"><span class="type">int</span> threshold_max = <span class="number">255</span>;<span class="comment">//最大阈值</span></span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">threshold_Demo</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;<span class="comment">//声明回调函数</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;test.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this img...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;input image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;output image&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;input image&quot;</span>, src);</span><br><span class="line"><span class="built_in">createTrackbar</span>(<span class="string">&quot;threshold&quot;</span>, <span class="string">&quot;output image&quot;</span>, &amp;threshold_value, threshold_max, threshold_Demo);<span class="comment">//创建滑动条</span></span><br><span class="line"><span class="built_in">threshold_Demo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">threshold_Demo</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line"><span class="built_in">cvtColor</span>(src, dst, COLOR_BGR2GRAY);<span class="comment">//转换为灰度图</span></span><br><span class="line"><span class="built_in">threshold</span>(dst, dst, threshold_value, threshold_max, THRESH_BINARY);<span class="comment">//转换为二值图像</span></span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;output image&quot;</span>, dst); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="输入输出XML和YAML文件"><a href="#输入输出XML和YAML文件" class="headerlink" title="输入输出XML和YAML文件"></a>输入输出XML和YAML文件</h3><ul><li>XML，是“可扩展表示为语言”，任何满足XML命名规则的名称都可以标记，这就像不同的应用程序打开了大门</li><li>YAML是以数据为中心，而不是以置标语言为重点。YAML是一个可读性高，用来表达资料序列的格式。哦内阁制，YAML试图用一种比XML更敏捷的方式，来完成XML所完成的任务</li></ul><h4 id="FileStorage类操作文件的使用引导"><a href="#FileStorage类操作文件的使用引导" class="headerlink" title="FileStorage类操作文件的使用引导"></a>FileStorage类操作文件的使用引导</h4><p>XML是使用非常广泛的文件格式，可以利用XML或者YAML格式的文件存储和<strong>还原</strong>各式各样的数据结构。当然，他们还可以<strong>存储和载入</strong>任意复杂的数据结构，其中就包括了OpenCV相关周边的数据结构，以及各种原始数据类型，如整数和浮点数字和文本字符串。</p><p>过程：</p><ol><li>实例化一个 <code>FileStorage</code>类的对象，用默认带参数的构造函数完成初始化，或者用 <code>FileStorage::open()</code>成员函数辅助初始化。</li><li>使用流操作符&lt;&lt;进行文件写入操作，或者&gt;&gt;进行文件读取操作，类似C++中的文件输入输出流。</li><li>使用 <code>FileStorage::release()</code>函数析构掉 <code>FileStorage</code>类对象，同时关闭文件。</li></ol><h4 id="示例程序：XML和YAML文件的写入"><a href="#示例程序：XML和YAML文件的写入" class="headerlink" title="示例程序：XML和YAML文件的写入"></a>示例程序：XML和YAML文件的写入</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function">FileStorage <span class="title">fs</span><span class="params">(<span class="string">&quot;test.yaml&quot;</span>, FileStorage::WRITE)</span></span>;</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;frameCount&quot;</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line"><span class="type">time_t</span> rawtime;</span><br><span class="line"><span class="built_in">time</span>(&amp;rawtime);</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;calibrationDate&quot;</span> &lt;&lt; <span class="built_in">asctime</span>(<span class="built_in">localtime</span>(&amp;rawtime));</span><br><span class="line">Mat cameraMatrix = (<span class="built_in">Mat_</span>&lt;<span class="type">double</span>&gt;(<span class="number">3</span>, <span class="number">3</span>) &lt;&lt; <span class="number">1000</span>, <span class="number">0</span>, <span class="number">320</span>, <span class="number">0</span>, <span class="number">1000</span>, <span class="number">240</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">Mat distCoeffs = (<span class="built_in">Mat_</span>&lt;<span class="type">double</span>&gt;(<span class="number">5</span>, <span class="number">1</span>) &lt;&lt; <span class="number">0.1</span>, <span class="number">0.01</span>, <span class="number">-0.001</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;cameraMatrix&quot;</span> &lt;&lt; cameraMatrix &lt;&lt; <span class="string">&quot;distCoeffs&quot;</span> &lt;&lt; distCoeffs;</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;features&quot;</span> &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x = <span class="built_in">rand</span>() % <span class="number">640</span>;</span><br><span class="line"><span class="type">int</span> y = <span class="built_in">rand</span>() % <span class="number">480</span>;</span><br><span class="line">uchar lbp = <span class="built_in">rand</span>() % <span class="number">256</span>;</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;&#123;:&quot;</span> &lt;&lt; <span class="string">&quot;x&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;y&quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;lbp&quot;</span> &lt;&lt; <span class="string">&quot;[:&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">fs &lt;&lt; ((lbp &gt;&gt; j) &amp; <span class="number">1</span>);</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">fs &lt;&lt; <span class="string">&quot;]&quot;</span>;</span><br><span class="line">fs.<span class="built_in">release</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模板匹配（template-match）"><a href="#模板匹配（template-match）" class="headerlink" title="模板匹配（template match）"></a>模板匹配（template match）</h3><ul><li>模板也是一个小的图像，用小图像匹配的过程叫做模板匹配</li><li>从左到右，从上到下计算匹配度</li><li>计算归一化平方不同TM_SQDIFF_NORMED     -1<ul><li>$R(x,y)=\sum\limits_{x’y’}(T(x’,y’)-I(x+x’,y+y’))^2$</li></ul></li><li>计算归一化相关性TM_CCORR_NORMED       ——3</li><li><p>计算归一化相关系数TM_CCOEFF_NORMED   ——-5</p></li><li><p>相关API介绍</p><ul><li>matchTemplate(src,templ,result,method)</li><li>src-源图像，必须是8-bit或者32-bit浮点数图像</li><li>templ-模板图像，类型与输入图像一致</li><li>result-==输出结果，必须是单通道32位浮点数，假设源图像W*H，模板图像w*h，则结果必须为W-w+1，H-h+1的大小==</li><li>int method 使用的匹配方法</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> trackbar_value = TM_CCOEFF_NORMED;<span class="comment">//阈值，</span></span><br><span class="line"><span class="type">int</span> max_track = <span class="number">5</span>;<span class="comment">//最大阈值/类型数目</span></span><br><span class="line">Mat src, temp, dst;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">templateMatch_demo</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> </span>&#123;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;src.jpg&quot;</span>);</span><br><span class="line">temp = <span class="built_in">imread</span>(<span class="string">&quot;template.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!src.data || !temp.data) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//namedWindow(&quot;input img&quot;, WINDOW_AUTOSIZE);</span></span><br><span class="line"><span class="built_in">namedWindow</span>(<span class="string">&quot;output img&quot;</span>, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">createTrackbar</span>(<span class="string">&quot;templatemacth&quot;</span>, <span class="string">&quot;output img&quot;</span>, &amp;trackbar_value, max_track, templateMatch_demo);<span class="comment">//创建滑动条</span></span><br><span class="line"><span class="built_in">templateMatch_demo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">templateMatch_demo</span><span class="params">(<span class="type">int</span> ,<span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> height = src.rows - temp.rows + <span class="number">1</span>;<span class="comment">//格式要求：大-小+1</span></span><br><span class="line"><span class="type">int</span> width = src.cols - temp.cols + <span class="number">1</span>;</span><br><span class="line"><span class="function">Mat <span class="title">result</span><span class="params">(width, height, CV_32FC1)</span></span>;<span class="comment">//要求输出32位单通道用于模板匹配</span></span><br><span class="line"><span class="built_in">matchTemplate</span>(src, temp, result, trackbar_value,<span class="built_in">Mat</span>());<span class="comment">//模板匹配</span></span><br><span class="line"><span class="built_in">normalize</span>(result, result, <span class="number">0</span>, <span class="number">1</span>, NORM_MINMAX,<span class="number">-1</span>,<span class="built_in">Mat</span>());<span class="comment">//归一化0-1图像</span></span><br><span class="line">Point minLoc, maxLoc,temLoc;<span class="comment">//定位</span></span><br><span class="line">src.<span class="built_in">copyTo</span>(dst);<span class="comment">//把源图像给dst</span></span><br><span class="line"><span class="type">double</span> min, max;</span><br><span class="line"><span class="built_in">minMaxLoc</span>(result, &amp;min, &amp;max, &amp;minLoc, &amp;maxLoc,<span class="built_in">Mat</span>());</span><br><span class="line"><span class="keyword">if</span> (trackbar_value == TM_SQDIFF || trackbar_value == TM_SQDIFF_NORMED) &#123;</span><br><span class="line">temLoc = minLoc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> temLoc = maxLoc;</span><br><span class="line"></span><br><span class="line"><span class="built_in">rectangle</span>(dst, <span class="built_in">Rect</span>(temLoc.x, temLoc.y, temp.cols, temp.rows), <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>),<span class="number">2</span>,<span class="number">8</span>);<span class="comment">//在dst上画出框</span></span><br><span class="line"><span class="built_in">rectangle</span>(result, <span class="built_in">Rect</span>(temLoc.x, temLoc.y, temp.cols, temp.rows), <span class="built_in">Scalar</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>),<span class="number">2</span>,<span class="number">8</span>);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;output img&quot;</span>, result);</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;match&quot;</span>, dst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="轮廓发现（find-contour-in-your-image）"><a href="#轮廓发现（find-contour-in-your-image）" class="headerlink" title="轮廓发现（find contour in your image）"></a>轮廓发现（find contour in your image）</h3><ul><li><strong>轮廓发现</strong>是基于图像边缘提取的基础寻找对象轮廓的方法。所以边缘提取的阈值选定会影响最终轮廓发现效果</li><li><strong>API介绍</strong><ul><li><strong>findContours</strong>发现轮廓<ul><li>img 输入图像，非0的像素被看成1，0的像素保持不变，8-bit</li><li>contours 全部发现的轮廓对象</li><li>hierachy 图像的拓扑结构，可选，该轮廓发现算法正是基于图像拓扑结构实现</li><li>mode 轮廓返回的模式</li><li>method 发现方法</li><li>Point offset-Point（） 轮廓像素的位移，默认（0，0）没有位移</li></ul></li><li><strong>drawContours</strong>绘制轮廓<ul><li>img 输出图像</li><li>contours 全部发现的轮廓对象</li><li>contourldx 轮廓索引号</li><li>color 绘制时候颜色</li><li>thickness 绘制线宽</li><li>lineType 线的类型LINE_8</li><li>hierarchy 拓扑结构图</li><li>maxlevel最大层数，0表示只绘制当前的，1表示绘制当前及其内嵌的轮廓</li></ul></li></ul></li><li>过程<ul><li>输入图像转为灰度图像cvtColor</li><li>使用<strong>Canny</strong>进行边缘提取，得到二值图像</li><li>使用<strong>findContours</strong>寻找轮廓</li><li>使用<strong>drawContours</strong>绘制轮廓</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> threshold_value = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">Mat src, dst;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Demo_Contours</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;</span><br><span class="line">RNG rng;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat3.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Demo_Contours</span>(<span class="number">0</span>, <span class="number">0</span>);<span class="comment">//contours轮廓</span></span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Demo_Contours</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line">vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">vector&lt;Vec4i&gt; hierarchy;</span><br><span class="line"><span class="built_in">Canny</span>(src, dst, threshold_value, threshold_value * <span class="number">2</span>, <span class="number">3</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">//Canny（输入，输出，低阈值，高阈值（低阈值的2·3倍），3，false）；</span></span><br><span class="line"><span class="built_in">findContours</span>(dst, contours, hierarchy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));<span class="comment">//寻找轮廓</span></span><br><span class="line">Mat drawImg = Mat::<span class="built_in">zeros</span>(dst.<span class="built_in">size</span>(), CV_8UC3);<span class="comment">//8bit3通道的彩色图像</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123; </span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));<span class="comment">//RNG rng生成一个随机数。</span></span><br><span class="line"><span class="built_in">drawContours</span>(drawImg, contours, i, color, <span class="number">2</span>, LINE_8, hierarchy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));<span class="comment">//画出轮廓（颜色随机），</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(<span class="string">&quot;output&quot;</span>, drawImg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="凸包-Convex-Hull"><a href="#凸包-Convex-Hull" class="headerlink" title="凸包-Convex Hull"></a>凸包-Convex Hull</h3><ul><li>在一个多边形边缘或者内部任意两个点的连线都包含在多边形边界或者内部—-包含集合S中所有点的最小凸多边形称为凸包</li></ul><blockquote><p>Graham扫描算法</p></blockquote><ul><li>首先选择Y方向最低的点作为起始点P0</li><li>从P0开始极坐标扫描，依次添加p1…pn(排序顺序是根据极坐标的角度大小，逆时针方向)</li><li>对每个点pi来说，如果添加pi点到凸包中导致一个左转向（逆时针方向）则添加该点到凸包，反之则从凸包中删除该点。</li></ul><h3 id="API说明-convexHull"><a href="#API说明-convexHull" class="headerlink" title="API说明  convexHull"></a>API说明  convexHull</h3><ul><li>convexHull(</li><li>pointd,//输入候选点，来自findContours</li><li>hull//凸包</li><li>bool clockwise//顺时针方向</li><li>returnPoints)//true表示返回点荷属，如果第二个参数是vector<Point>则自动忽略</li></ul><h3 id="凸包代码演示（凸包只是一个比较特殊的轮廓而已）"><a href="#凸包代码演示（凸包只是一个比较特殊的轮廓而已）" class="headerlink" title="凸包代码演示（凸包只是一个比较特殊的轮廓而已）"></a>凸包代码演示（凸包只是一个比较特殊的轮廓而已）</h3><ul><li>首先把图像从RGB转为灰度</li><li>然后再转为二值图像</li><li>再通过发现轮廓得到候选点</li><li>凸包API调用</li><li>绘制显示</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> threshold_value = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">Mat src,src_gray;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Thershold_Callback</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;</span><br><span class="line"><span class="function">RNG <span class="title">rng</span><span class="params">(<span class="number">12345</span>)</span></span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* OUTPUT = <span class="string">&quot;output&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* TRACKBAR = <span class="string">&quot;trackbar&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cvtColor</span>(src, src_gray, COLOR_BGR2GRAY);<span class="comment">//先转化为灰度图像</span></span><br><span class="line"><span class="built_in">blur</span>(src_gray, src_gray, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));<span class="comment">//然后进行模糊，降低噪声，以用来更好的二值化</span></span><br><span class="line"><span class="built_in">namedWindow</span>(OUTPUT, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">createTrackbar</span>(TRACKBAR, OUTPUT, &amp;threshold_value, threshold_max, Thershold_Callback);</span><br><span class="line"><span class="built_in">Thershold_Callback</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Thershold_Callback</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line">Mat threshold_output;</span><br><span class="line">vector&lt;vector&lt;Point&gt;&gt; contours;</span><br><span class="line">vector&lt;Vec4i&gt; hierarchy;</span><br><span class="line"><span class="built_in">threshold</span>(src_gray, threshold_output, threshold_value, threshold_max, THRESH_BINARY);<span class="comment">//转化为二值图像</span></span><br><span class="line"><span class="built_in">findContours</span>(threshold_output, contours, hierarchy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));<span class="comment">//通过发现轮廓的到候选点</span></span><br><span class="line">vector&lt;vector&lt;Point&gt;&gt; <span class="built_in">hull</span>(contours.<span class="built_in">size</span>());</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line"><span class="built_in">convexHull</span>(<span class="built_in">Mat</span>(contours[i]), hull[i], <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">Mat dst = Mat::<span class="built_in">zeros</span>(threshold_output.<span class="built_in">size</span>(), CV_8UC3);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line"><span class="built_in">drawContours</span>(dst, hull, i, color, <span class="number">1</span>, LINE_8, hierarchy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"><span class="built_in">drawContours</span>(dst, contours, i, color, <span class="number">1</span>, LINE_8, hierarchy, <span class="number">0</span>, <span class="built_in">Point</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(OUTPUT, dst);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="轮廓周围绘制矩形框和圆形框"><a href="#轮廓周围绘制矩形框和圆形框" class="headerlink" title="轮廓周围绘制矩形框和圆形框"></a>轮廓周围绘制矩形框和圆形框</h3><p>从彩色图像转化为灰度图像，然后进行模糊，然后进行二值化处理，或者使用Canny边缘检测</p><ul><li>API介绍<ul><li><code>approxPolyDP(InputArray curve,OutputArray approxCurve,double epsilon,bool closed)</code>基于RDP算法实现，目的是减少多边形轮廓点数</li><li>轮廓周围矩形绘制-API<ul><li><code>boundingRect(InputArray points)</code>得到轮廓周围最小矩形左上角点坐标和右下角点坐标，绘制一个矩形</li><li><code>minAreaRect(InputArray points)</code>得到一个旋转的矩形，返回旋转矩形</li></ul></li><li>轮廓周围绘制圆和椭圆-API<ul><li><code>minEnclosingCircle(InputArray points)</code>//得到最小区域圆形<ul><li>Point2f&amp; center //圆心位置</li><li>float&amp; radius//圆的半径</li></ul></li><li><code>fitEllipse(InputArray points)</code>得到最小椭圆</li></ul></li></ul></li><li>步骤<ul><li>首先将图像变为二值图像（先变为灰度图像，然后进行模糊，进而用阈值函数变为二值图像，或者用canny边缘检测变为二值图像）</li><li>发现轮廓，找到图像轮廓(<code>findContours</code>)</li><li>通过相关API再轮廓点上找到最小包含矩形和圆，旋转矩形与椭圆。</li><li>绘制他们</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//坏代码</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> threshold_value = <span class="number">170</span>;</span><br><span class="line"><span class="type">int</span> threshold_max = <span class="number">255</span>;</span><br><span class="line">Mat src, src_gray, dst;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Contours_Callback</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span></span>;</span><br><span class="line"><span class="function">RNG <span class="title">rng</span><span class="params">(<span class="number">12345</span>)</span></span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* OUTPUT = <span class="string">&quot;rectangle-Demo&quot;</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* TRACKBAR = <span class="string">&quot;trackbar&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">src = <span class="built_in">imread</span>(<span class="string">&quot;cat1.jpg&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (src.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;could not load this image...&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cvtColor</span>(src, src_gray, COLOR_BGR2GRAY);<span class="comment">//先转化为灰度图像</span></span><br><span class="line"><span class="built_in">blur</span>(src_gray, src_gray, <span class="built_in">Size</span>(<span class="number">3</span>, <span class="number">3</span>), <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));<span class="comment">//然后进行模糊，降低噪声，以用来更好的二值化</span></span><br><span class="line"><span class="built_in">namedWindow</span>(OUTPUT, WINDOW_AUTOSIZE);</span><br><span class="line"><span class="built_in">createTrackbar</span>(TRACKBAR, OUTPUT, &amp;threshold_value, threshold_max, Contours_Callback);</span><br><span class="line"><span class="built_in">Contours_Callback</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Contours_Callback</span><span class="params">(<span class="type">int</span>, <span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line">Mat binary_output;<span class="comment">//把灰度图像变为二值图像</span></span><br><span class="line">vector&lt;vector&lt;Point&gt;&gt;contours;</span><br><span class="line">vector&lt;Vec4i&gt; hierachy;</span><br><span class="line"><span class="built_in">threshold</span>(src_gray, binary_output, threshold_value, threshold_max, THRESH_BINARY);</span><br><span class="line"><span class="built_in">findContours</span>(binary_output, contours, hierachy, RETR_TREE, CHAIN_APPROX_SIMPLE, <span class="built_in">Point</span>(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line">vector&lt;vector&lt;Point&gt;&gt;<span class="built_in">contours_ploy</span>(contours.<span class="built_in">size</span>());</span><br><span class="line">vector&lt;Rect&gt;<span class="built_in">ploy_rects</span>(contours.<span class="built_in">size</span>());</span><br><span class="line"><span class="function">vector&lt;Point2f&gt; <span class="title">ccs</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">float</span>&gt; <span class="title">radius</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;RotatedRect&gt; <span class="title">minRect</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"><span class="function">vector&lt;RotatedRect&gt; <span class="title">myellipse</span><span class="params">(contours.size())</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line"><span class="built_in">approxPolyDP</span>(<span class="built_in">Mat</span>(contours[i]), contours_ploy[i], <span class="number">3</span>, <span class="literal">true</span>);<span class="comment">//初始化</span></span><br><span class="line"><span class="comment">/*ploy_rects[i] = boundingRect(contours_ploy[i]);</span></span><br><span class="line"><span class="comment">minEnclosingCircle(contours_ploy[i], ccs[i], radius[i]);*/</span></span><br><span class="line"><span class="keyword">if</span> (contours_ploy.<span class="built_in">size</span>() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">myellipse[i] = <span class="built_in">fitEllipse</span>(contours_ploy[i]);</span><br><span class="line">minRect[i] = <span class="built_in">minAreaRect</span>(contours_ploy[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">src.<span class="built_in">copyTo</span>(dst);</span><br><span class="line">Point2f pts[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; contours.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">Scalar color = <span class="built_in">Scalar</span>(rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>), rng.<span class="built_in">uniform</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (contours_ploy.<span class="built_in">size</span>() &gt; <span class="number">5</span>) &#123;</span><br><span class="line"><span class="comment">//rectangle(dst, ploy_rects[i], color, 2, LINE_8);</span></span><br><span class="line"><span class="comment">//circle(dst, ccs[i], radius[i], color, 2, LINE_8);</span></span><br><span class="line"><span class="built_in">ellipse</span>(dst, myellipse[i], color, <span class="number">1</span>, LINE_8);</span><br><span class="line">minRect[i].<span class="built_in">points</span>(pts);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line"><span class="built_in">line</span>(dst, pts[r], pts[(r + <span class="number">1</span>) % <span class="number">4</span>], color, <span class="number">1</span>, LINE_8);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">imshow</span>(OUTPUT, dst);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="图像矩（Image-Moments）"><a href="#图像矩（Image-Moments）" class="headerlink" title="图像矩（Image Moments）"></a>图像矩（Image Moments）</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;opencv-note&quot;&gt;&lt;a href=&quot;#opencv-note&quot; class=&quot;headerlink&quot; title=&quot;opencv note&quot;&gt;&lt;/a&gt;opencv note&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;第一章 安装&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;第</summary>
      
    
    
    
    
    <category term="计算机视觉" scheme="http://michael8023.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://michael8023.github.io/post/4a17b156.html"/>
    <id>http://michael8023.github.io/post/4a17b156.html</id>
    <published>2022-10-29T13:20:05.693Z</published>
    <updated>2022-10-31T08:32:40.822Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
